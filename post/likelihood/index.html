<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.40.3" />
  <meta name="author" content="王 超辰 (Chaochen Wang)">
  <meta name="description" content="Assistant Professor">

  
  <link rel="alternate" hreflang="en-us" href="https://winterwang.github.io/post/likelihood/">

  
  


  

  
  
  
  
    
  
  
    
    
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
    
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.1/css/academicons.min.css" integrity="sha512-NThgw3XKQ1absAahW6to7Ey42uycrVvfNfyjqcFNgCmOCQ5AR4AO0SiXrN+8ZtYeappp56lk1WtvjVmEa+VR6A==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.2.0/leaflet.css" integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ==" crossorigin="anonymous">
  
  
  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Playfair&#43;Display:400,700%7cFauna&#43;One">
  
  <link rel="stylesheet" href="/styles.css">
  

  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-21867861-1', 'auto');
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="//www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  

  
  <link rel="alternate" href="https://winterwang.github.io/index.xml" type="application/rss+xml" title="Be ambitious">
  <link rel="feed" href="https://winterwang.github.io/index.xml" type="application/rss+xml" title="Be ambitious">
  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="https://winterwang.github.io/post/likelihood/">

  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="Be ambitious">
  <meta property="og:url" content="https://winterwang.github.io/post/likelihood/">
  <meta property="og:title" content="似然非然 Likelihood | Be ambitious">
  <meta property="og:description" content="">
  <meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2017-11-02T00:00:00&#43;00:00">
  
  <meta property="article:modified_time" content="2017-11-02T00:00:00&#43;00:00">
  

  

  <title>似然非然 Likelihood | Be ambitious</title>

</head>
<body id="top" data-spy="scroll" data-target="#toc" data-offset="71" >

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
      <a class="navbar-brand" href="/">Be ambitious</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      
      <ul class="nav navbar-nav navbar-right">
        

        

        
          
        

        <li class="nav-item">
          <a href="/#about">
            
            <span>Home</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#publications_selected">
            
            <span>Publications</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#posts">
            
            <span>Posts</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#projects">
            
            <span>Projects</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#teaching">
            
            <span>Teaching</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#slides">
            
            <span>Presentations/slides</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#contact">
            
            <span>Contact</span>
            
          </a>
        </li>

        
        
      

      
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  


  <div class="article-container">
    <div class="article-inner">
      <h1 itemprop="name">似然非然 Likelihood</h1>

      

<div class="article-metadata">

  <span class="article-date">
    
    <time datetime="2017-11-02 00:00:00 &#43;0000 UTC" itemprop="datePublished">
      Thu, Nov 2, 2017
    </time>
  </span>

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    3 min read
  </span>
  

  
  
  <span class="middot-divider"></span>
  <a href="https://winterwang.github.io/post/likelihood/#disqus_thread"></a>
  

  
  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fa fa-folder"></i>
    
    <a href="/categories/statistics">statistics</a
    >, 
    
    <a href="/categories/study-abroad">study abroad</a
    >
    
  </span>
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=%e4%bc%bc%e7%84%b6%e9%9d%9e%e7%84%b6%20Likelihood&amp;url=https%3a%2f%2fwinterwang.github.io%2fpost%2flikelihood%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fwinterwang.github.io%2fpost%2flikelihood%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwinterwang.github.io%2fpost%2flikelihood%2f&amp;title=%e4%bc%bc%e7%84%b6%e9%9d%9e%e7%84%b6%20Likelihood"
         target="_blank" rel="noopener">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=https%3a%2f%2fwinterwang.github.io%2fpost%2flikelihood%2f&amp;title=%e4%bc%bc%e7%84%b6%e9%9d%9e%e7%84%b6%20Likelihood"
         target="_blank" rel="noopener">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=%e4%bc%bc%e7%84%b6%e9%9d%9e%e7%84%b6%20Likelihood&amp;body=https%3a%2f%2fwinterwang.github.io%2fpost%2flikelihood%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>


      <div class="article-style" itemprop="articleBody">
        <div id="-vs.probability-vs.inference" class="section level3">
<h3>概率 vs. 推斷/Probability vs. Inference</h3>
<p>在概率論的環境下，我們常常被告知的前提是：某某事件發生的概率是多少。例如： 一枚硬幣正面朝上的概率是 <span class="math inline">\(0.5\; Prob(coin\;landing\;heads)=0.5\)</span>。然後在這個前提下，我們又繼續去計算複雜的事件發生的概率（例如，10次投擲硬幣以後4次正面朝上的概率是多少？）。</p>
<p><span class="math display">\[
\binom{10}{4}\times(0.5^4)\times(0.5^{10-4}) = 0.205
\]</span></p>
<pre class="r"><code>dbinom(4, 10, 0.5)</code></pre>
<pre><code>## [1] 0.2050781</code></pre>
<pre class="r"><code># or you can calculate by hand:
factorial(10)*(0.5^10)/(factorial(4)*(factorial(6)))</code></pre>
<pre><code>## [1] 0.2050781</code></pre>
<p>在統計推斷的理論中，我們考慮實際的情況，這樣的實際情況就是，我們通過觀察獲得數據，然而我們並不知道某事件發生的概率到底是多少（神如果存在話，只有神知道）。故這個 <span class="math inline">\(Prob(coin\;landing\;heads)\)</span> 的概率大小對於“人類”來說是未知的。我們可能觀察到投擲了10次硬幣，其中有4次是正面朝上的。那麼我們從這一次觀察實驗中，需要計算的是能夠符合觀察結果的“最佳”概率估計 (best estimate)。在這種情況下，<strong>似然法 (likelihood)</strong> 就是我們進行參數估計的最佳手段。</p>
</div>
<div class="section level3">
<h3>似然和極大似然估計</h3>
<p>此處用二項分佈的例子來理解似然法的概念：假設我們觀察到10個對象中有4個患病，我們假定這個患病的概率爲 <span class="math inline">\(\pi\)</span>。於是我們就有了下面的模型：</p>
<p><strong>模型：</strong> 我們假定患病與否是一個服從<strong>二項分佈的隨機變量</strong>，<span class="math inline">\(X\sim Bin(10,\pi)\)</span>。同時也默認每個人之間是否患病是相互獨立的。</p>
<p><strong>數據：</strong> 觀察到的數據是，10人中有4人患病。於是 <span class="math inline">\(x=4\)</span>。</p>
<p>現在按照觀察到的數據，參數 <span class="math inline">\(\pi\)</span> 變成了未知數：</p>
<p><span class="math display">\[Prob(X=4|\pi)=\binom{10}{4}\pi^4(1-\pi)^{10-4}\]</span></p>
<p>此時我們會很自然的考慮，當 <span class="math inline">\(\pi\)</span> 是未知數的時候，<strong>它取值爲多大的時候才能讓這個事件（即：10人中4人患病）發生的概率最大？</strong> 所以我們可以將不同的數值代入 <span class="math inline">\(\pi\)</span> 來計算該事件在不同概率的情況下發生的可能性到底是多少：</p>
<table class="table table-striped table-bordered" style="margin-left: auto; margin-right: auto;">
<caption>
Table 1: The probability of observing <span class="math inline">\(X=4\)</span>
</caption>
<thead>
<tr>
<th style="text-align:center;">
<span class="math inline">\(\pi\)</span>
</th>
<th style="text-align:center;">
事件 <span class="math inline">\(X=4\)</span> 發生的概率
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
0.0
</td>
<td style="text-align:center;">
0.000
</td>
</tr>
<tr>
<td style="text-align:center;">
0.2
</td>
<td style="text-align:center;">
0.088
</td>
</tr>
<tr>
<td style="text-align:center;">
<strong>0.4</strong>
</td>
<td style="text-align:center;">
<strong>0.251</strong>
</td>
</tr>
<tr>
<td style="text-align:center;">
0.5
</td>
<td style="text-align:center;">
0.205
</td>
</tr>
<tr>
<td style="text-align:center;">
0.6
</td>
<td style="text-align:center;">
0.111
</td>
</tr>
<tr>
<td style="text-align:center;">
0.8
</td>
<td style="text-align:center;">
0.006
</td>
</tr>
<tr>
<td style="text-align:center;">
1.0
</td>
<td style="text-align:center;">
0.000
</td>
</tr>
</tbody>
</table>
<p>很顯然，如果 <span class="math inline">\(\pi=0.4\)</span> 時，我們觀察到的事件發生的概率要比 <span class="math inline">\(\pi\)</span> 取其它值時更大。於是小總結一下目前爲止的步驟如下：</p>
<ul>
<li>觀察到實驗數據（10人中4個患病）；</li>
<li>假定這數據服從二項分佈的概率模型，計算不同（<span class="math inline">\(\pi\)</span> 的取值不同的）情況下，該事件按照假定模型發生的概率；</li>
<li>通過比較，我們選擇了能夠讓觀察事件發生概率最高的參數取值 (<span class="math inline">\(\pi=0.4\)</span>)。</li>
</ul>
<p>至此，我們可以知道，似然方程，是一個關於未知參數 <span class="math inline">\(\pi\)</span> 的函數，我們目前位置做的就是找到這個函數的最大值 (maximised)，和使之成爲最大值時的 <span class="math inline">\(\pi\)</span> ：</p>
<p><span class="math display">\[L(\pi|X=4)=\binom{10}{4}\pi^4(1-\pi)^{10-4}\]</span></p>
<p>我們可以畫出這個似然方程的形狀， <span class="math inline">\(\pi\in[0,1]\)</span></p>
<pre class="r"><code>x &lt;- seq(0,1,by=0.001)
y &lt;- (factorial(10)/(factorial(4)*(factorial(6))))*(x^4)*((1-x)^6)
plot(x, y, type = &quot;l&quot;, ylim = c(0,0.3), ylab = &quot;L(\U03C0)&quot;, xlab = &quot;\U03C0&quot;)
title(&quot;Figure 1. Binomial Likelihood&quot;)
abline(h=0.251, lty=2)
abline(v=0.4, lty=2)</code></pre>
<p><img src="/post/2017-11-02-likelihood_files/figure-html/unnamed-chunk-3-1.png" width="480" /></p>
<p>從圖形上我們也能確認，<span class="math inline">\(\pi=0.4\)</span> 時能夠讓這個似然方程取得最大值。</p>
</div>
<div class="section level3">
<h3>似然方程的一般化定義</h3>
<p>對於一個概率模型，如果其參數爲 <span class="math inline">\(\theta\)</span>，那麼在給定觀察數據 <span class="math inline">\(\underline{x}\)</span> 時，該參數的似然方程被定義爲：</p>
<p><span class="math inline">\(L(\theta|\underline{x})=P(\underline{x}|\theta)\)</span></p>
<p>注意：</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(P(\underline{x}|\theta)\)</span> 可以是概率（離散分佈）方程，也可以是概率密度（連續型變量）方程。對於此方程，<span class="math inline">\(\theta\)</span> 是給定的，然後再計算某些事件發生的概率。</li>
<li><span class="math inline">\(L(\theta|\underline{x})\)</span> 是一個關於參數 <span class="math inline">\(\theta\)</span> 的方程，此時，<span class="math inline">\(\underline{x}\)</span> 是固定不變的（觀察值）。我們希望通過這個方程求出能夠使觀察到的事件發生概率最大的參數值。</li>
<li>似然方程<strong>不是</strong>一個概率密度方程。</li>
</ol>
<p>另一個例子：</p>
<p>有一組觀察數據是離散型隨機變量 <span class="math inline">\(X\)</span>，它符合概率方程 <span class="math inline">\(f(x|\theta)\)</span>。下表羅列了當 <span class="math inline">\(\theta\)</span> 分別取值 <span class="math inline">\(1,2,3\)</span> 時的概率方程的值，試求每個觀察值 <span class="math inline">\(X = 0,1,2,3,4\)</span> 的最大似然參數估計：</p>
<table class="table table-striped table-bordered" style="margin-left: auto; margin-right: auto;">
<caption>
Exercise 1
</caption>
<thead>
<tr>
<th style="text-align:center;">
<span class="math inline">\(x\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(f(x|1)\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(f(x|2)\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(f(x|3)\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1/3
</td>
<td style="text-align:center;">
1/4
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1/3
</td>
<td style="text-align:center;">
1/4
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1/4
</td>
<td style="text-align:center;">
1/6
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
1/6
</td>
<td style="text-align:center;">
1/4
</td>
<td style="text-align:center;">
1/2
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
1/6
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1/3
</td>
</tr>
</tbody>
</table>
<table class="table table-striped table-bordered" style="margin-left: auto; margin-right: auto;">
<caption>
Exercise 1 answer
</caption>
<thead>
<tr>
<th style="text-align:center;">
<span class="math inline">\(x\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(f(x|1)\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(f(x|2)\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(f(x|3)\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(\theta\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1/3
</td>
<td style="text-align:center;">
1/4
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
<strong>1</strong>
</td>
</tr>
<tr>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1/3
</td>
<td style="text-align:center;">
1/4
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
<strong>1</strong>
</td>
</tr>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1/4
</td>
<td style="text-align:center;">
1/6
</td>
<td style="text-align:center;">
<strong>2</strong>
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
1/6
</td>
<td style="text-align:center;">
1/4
</td>
<td style="text-align:center;">
1/2
</td>
<td style="text-align:center;">
<strong>3</strong>
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
1/6
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1/3
</td>
<td style="text-align:center;">
<strong>3</strong>
</td>
</tr>
</tbody>
</table>
</div>
<div id="-log-likelihood" class="section level3">
<h3>對數似然方程 log-likelihood</h3>
<p>似然方程的最大值，可通過求 <span class="math inline">\(L(\theta|data)\)</span> 的最大值獲得，也可以通過求該方程的對數方程 <span class="math inline">\(\ell(\theta|data)\)</span> 的最大值獲得。傳統上，我們估計最大方程的最大值的時候，會給參數戴一頂“帽子”（因爲這是觀察獲得的數據告訴我們的參數）： <span class="math inline">\(\hat{\theta}\)</span>。並且我們發現對數似然方程比一般的似然方程更加容易微分，因此求似然方程的最大值就變成了求對數似然方程的最大值：</p>
<p><span class="math display">\[\frac{d\ell}{d\theta}=\ell^\prime(\theta)=0\\
AND\\
\frac{d^2\ell}{d\theta^2}&lt;0\]</span></p>
<p>要注意的是，微分不一定總是能幫助我們求得似然方程的最大值。如果說參數本身的定義域是有界限的話，微分就行不通了：</p>
<pre class="r"><code>x &lt;- seq(0,3,by=0.001)
y &lt;- (x-1)^2-5
plot(x, y, type = &quot;l&quot;, ylim = c(-5,0-1), ylab = &quot;L(\U03B8)&quot;, xlab = &quot;\U03B8&quot;)
title(&quot;Figure 2. Likelihood function with \n a limited domain&quot;)
abline(v=3, lty=2)</code></pre>
<p><img src="/post/2017-11-02-likelihood_files/figure-html/unnamed-chunk-6-1.png" width="480" /></p>
<div id="-lthetadata--ellthetadata-" class="section level4">
<h4>證明：當 <span class="math inline">\(L(\theta|data)\)</span> 取最大值時，該方程的對數方程 <span class="math inline">\(\ell(\theta|data)\)</span> 也是最大值：</h4>
<p>如果似然方程是連續可導，只有一個最大值，且可以二次求導，假設 <span class="math inline">\(\hat{\theta}\)</span> 使該方程取最大值，那麼：</p>
<p><span class="math display">\[\frac{dL}{d\theta}=0, \frac{d^2L}{d\theta^2}&lt;0 \Rightarrow \theta=\hat{\theta}\]</span></p>
<p>令 <span class="math inline">\(\ell=logL\)</span> 那麼 <span class="math inline">\(\frac{d\ell}{dL}=\ell^\prime=\frac{1}{L}\)</span>：</p>
<p><span class="math display">\[\frac{d\ell}{d\theta}=\frac{d\ell}{dL}\cdot\frac{dL}{d\theta}=\frac{1}{L}\cdot\frac{dL}{d\theta}\]</span></p>
<p>當 <span class="math inline">\(\ell(\theta|data)\)</span> 取最大值時：</p>
<p><span class="math display">\[\frac{d\ell}{d\theta}=0\Leftrightarrow\frac{1}{L}\cdot\frac{dL}{d\theta}=0\\
\because \frac{1}{L}\neq0 \\
\therefore \frac{dL}{d\theta}=0\\
\Leftrightarrow \theta=\hat{\theta}\]</span></p>
<p><span class="math display">\[
\begin{aligned}
\frac{d^2\ell}{d\theta^2} &amp;= \frac{d}{d\theta}(\frac{d\ell}{dL}\cdot\frac{dL}{d\theta})\\
 &amp;= \frac{d\ell}{dL}\cdot\frac{d^2L}{d\theta^2} + \frac{dL}{d\theta}\cdot\frac{d}{d\theta}(\frac{d\ell}{dL})
\end{aligned}
\]</span></p>
<p>當 <span class="math inline">\(\theta=\hat{\theta}\)</span> 時，<span class="math inline">\(\frac{dL}{d\theta}=0\)</span> 且 <span class="math inline">\(\frac{d^2L}{d\theta^2}&lt;0 \Rightarrow \frac{d^2\ell}{d\theta^2}&lt;0\)</span></p>
<p>所以，求獲得 <span class="math inline">\(\ell(\theta|data)\)</span> 最大值的 <span class="math inline">\(\theta\)</span> 即可令 <span class="math inline">\(L(\theta|data)\)</span> 獲得最大值。</p>
</div>
</div>
<div id="-maximum-likelihood-estimator-mle-" class="section level3">
<h3>極大似然估計 (maximum likelihood estimator, MLE) 的性質：</h3>
<ol style="list-style-type: decimal">
<li>漸進無偏 Asymptotically unbiased: <br> <span class="math inline">\(n\rightarrow \infty \Rightarrow E(\hat{\Theta}) \rightarrow \theta\)</span></li>
<li>漸進最高效能 Asymptotically efficient: <br> <span class="math inline">\(n\rightarrow \infty \Rightarrow Var(\hat{\Theta})\)</span> 是所有參數中方差最小的估計</li>
<li>漸進正態分佈 Asymptotically normal: <br> <span class="math inline">\(n\rightarrow \infty \Rightarrow \hat{\Theta} \sim N(\theta, Var(\hat{\Theta}))\)</span></li>
<li>變形後依然保持不變 Transformation invariant: <br> <span class="math inline">\(\hat{\Theta}\)</span> 是 <span class="math inline">\(\theta\)</span> 的MLE時 <span class="math inline">\(\Rightarrow g(\hat{\Theta})\)</span> 是 <span class="math inline">\(g(\theta)\)</span> 的 MLE</li>
<li>信息足夠充分 Sufficient：<br> <span class="math inline">\(\hat{\Theta}\)</span> 包含了觀察數據中所有的能夠用於估計參數的信息</li>
<li>始終不變 consistent: <br> <span class="math inline">\(n\rightarrow\infty\Rightarrow\hat{\Theta}\rightarrow\theta\)</span> 或者可以寫成：<span class="math inline">\(\varepsilon&gt;0, lim_{n\rightarrow\infty}P(|\hat{\Theta}-\theta|&gt;\varepsilon)=0\)</span></li>
</ol>
</div>
<div id="-likelihood-for-a-rate" class="section level3">
<h3>率的似然估計 Likelihood for a rate</h3>
<p>如果在一項研究中，參與者有各自不同的追蹤隨訪時間（長度），那麼我們應該把事件（疾病）的發病率用率的形式（多少事件每單位人年, e.g. per person year of observation）。如果這個發病率的參數用 <span class="math inline">\(\lambda\)</span> 來表示，所有參與對象的隨訪時間之和爲 <span class="math inline">\(p\)</span> 人年。那麼這段時間內的期望事件（疾病發病）次數爲：<span class="math inline">\(\mu=\lambda p\)</span>。假設事件（疾病發病）發生是相互獨立的，可以使用泊松分佈來模擬期望事件（疾病發病）次數 <span class="math inline">\(D\)</span>：</p>
<p><span class="math display">\[D\sim Poi(\mu)\]</span></p>
<p>假設我們觀察到了 <span class="math inline">\(D=d\)</span> 個事件，我們獲得這個觀察值的概率應該用以下的模型：</p>
<p><span class="math display">\[Prob(D=d)=e^{-\mu}\frac{\mu^d}{d!}=e^{-\lambda p}\frac{\lambda^dp^d}{d!}\]</span></p>
<p>因此，<span class="math inline">\(\lambda\)</span> 的似然方程是：</p>
<p><span class="math display">\[L(\lambda|observed \;data)=e^{-\lambda p}\frac{\lambda^dp^d}{d!}\]</span></p>
<p>所以，<span class="math inline">\(\lambda\)</span> 的對數似然方程是：</p>
<p><span class="math display">\[
\begin{aligned}
\ell(\lambda|observed\;data) &amp;= log(e^{-\lambda p}\frac{\lambda^dp^d}{d!}) \\
  &amp;= -\lambda p+d\:log(\lambda)+d\:log(p)-log(d!) \\
\end{aligned}
\]</span></p>
<p>解 <span class="math inline">\(\ell^\prime(\lambda|data)=0\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
\ell^\prime(\lambda|data) &amp;= -p+\frac{d}{\lambda}=0\\
\Rightarrow \hat{\lambda} &amp;= \frac{d}{p} \\
\end{aligned}
\]</span></p>
<p><strong>注意：</strong>
在對數似然方程中，不包含參數的部分，對與似然方程的形狀不產生任何影響，我們在微分對數似然方程的時候，這部分也都自動消失。所以不包含參數的部分，與我們如何獲得極大似然估計是無關的。因此，我們常常在寫對數似然方程的時候就把其中沒有參數的部分直接忽略了。例如上面泊松分佈的似然方程中，<span class="math inline">\(d\:log(p)-log(d!)\)</span> 不包含參數 <span class="math inline">\(\lambda\)</span> 可以直接不寫出來。</p>
</div>
<div id="-n-" class="section level3">
<h3>有 <span class="math inline">\(n\)</span> 個獨立觀察時的似然方程和對數似然方程</h3>
<p>當有多個獨立觀察時，總體的似然方程等於各個觀察值的似然方程之<strong>乘積</strong>。如果 <span class="math inline">\(X_1,\dots,X_n\stackrel{i.i.d}{\sim}f(\cdot|\theta)\)</span></p>
<p><span class="math display">\[L(\theta|x_1,\cdots,x_n)=f(x_1,\cdots,x_n|\theta)=\prod_{i=1}^nf(x_i|\theta)\\
\Rightarrow \ell(\theta|x_1,\cdots,x_n)=\sum_{i=1}^nlog(f(x_i|\theta))\]</span></p>
</div>

      </div>

      


<div class="article-tags">
  
  <a class="btn btn-primary btn-outline" href="/tags/medical-statistics">Medical Statistics</a>
  
  <a class="btn btn-primary btn-outline" href="/tags/inference">inference</a>
  
  <a class="btn btn-primary btn-outline" href="/tags/learning-notes">learning notes</a>
  
  <a class="btn btn-primary btn-outline" href="/tags/london">London</a>
  
  <a class="btn btn-primary btn-outline" href="/tags/lshtm">LSHTM</a>
  
</div>



    </div>
  </div>

</article>



<div class="article-container article-widget">
  <div class="hr-light"></div>
  <h3>Related</h3>
  <ul>
    
    <li><a href="/post/chi-square-distribution/">卡方分佈 chi square distribution</a></li>
    
    <li><a href="/post/frequentist-statistical-inference02/">估計和精確度的概念</a></li>
    
    <li><a href="/post/frequentist-statistical-inference01/">概率論者統計推斷入門之-被門夾住</a></li>
    
    <li><a href="/post/sample-size-in-clinical-trial/">臨牀實驗的樣本量計算問題 Sample Size in Clinical Trial</a></li>
    
    <li><a href="/post/central-limit-theory/">偉大的中心極限定理</a></li>
    
  </ul>
</div>



<div class="container article-widget">
  <nav>
  <ul class="pager">
    
    <li class="previous"><a href="https://winterwang.github.io/post/sample-size-in-clinical-trial/"><span
      aria-hidden="true">&larr;</span> 臨牀實驗的樣本量計算問題 Sample Size in Clinical Trial</a></li>
    

    
    <li class="next"><a href="https://winterwang.github.io/post/log-likelihood-ratio/">對數似然比 Log-likelihood ratio <span
      aria-hidden="true">&rarr;</span></a></li>
    
  </ul>
</nav>

</div>


<div class="article-container">
  
<section id="comments">
  <div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "ccwang" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>


</div>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 2017 Chaochen Wang | 王超辰 &middot; 

      Powered by the
      <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
      <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>


<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close btn-large" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Cite</h4>
      </div>
      <div>
        <pre><code class="modal-body tex"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-primary btn-outline js-copy-cite" href="#" target="_blank">
          <i class="fa fa-copy"></i> Copy
        </a>
        <a class="btn btn-primary btn-outline js-download-cite" href="#" target="_blank">
          <i class="fa fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

    

    
    
    <script id="dsq-count-scr" src="//ccwang.disqus.com/count.js" async></script>
    

    

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha512-3P8rXCuGJdNZOnUx/03c1jOTnMn3rP63nBip5gOP2qmUh5YAdVAvFZ1E+QLZZbC1rtMrQb+mah3AfYW11RUrWA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.2.0/leaflet.js" integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log==" crossorigin="anonymous"></script>
    
    
    <script src="/js/hugo-academic.js"></script>
    

    
    
      
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
      

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML" integrity="sha512-tOav5w1OjvsSJzePRtt2uQPFwBoHt1VZcUq8l8nm5284LEKE9FSJBQryzMBzHxY5P0zRdNqEcpLIRVYFNgu1jw==" crossorigin="anonymous"></script>
    
    

  </body>
</html>

