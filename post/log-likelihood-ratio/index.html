<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.30.2" />
  <meta name="author" content="王　超辰 (Chaochen Wang)">
  

  
  
  
    
  
  
    
    
    <link rel="stylesheet" href="/css/highlight.min.css">
    
  
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/font-awesome.min.css">
  <link rel="stylesheet" href="/css/academicons.min.css">
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700|Merriweather|Roboto+Mono">
  <link rel="stylesheet" href="/css/hugo-academic.css">
  

  <link rel="alternate" href="https://winterwang.github.io/index.xml" type="application/rss+xml" title="Be ambitious">
  <link rel="feed" href="https://winterwang.github.io/index.xml" type="application/rss+xml" title="Be ambitious">

  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/apple-touch-icon.png">

  <link rel="canonical" href="https://winterwang.github.io/post/log-likelihood-ratio/">

  

  <title>對數似然比 Log-likelihood ratio | Be ambitious</title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Be ambitious</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="/#about">
            
            <span>Home</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#publications_selected">
            
            <span>Publications</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#posts">
            
            <span>Posts</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#projects">
            
            <span>Projects</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#teaching">
            
            <span>Teaching</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#slides">
            
            <span>Presentations/slides</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#contact">
            
            <span>Contact</span>
          </a>
        </li>

        
        
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  

  <div class="article-container">
    <h1 itemprop="name">對數似然比 Log-likelihood ratio</h1>
    

<div class="article-metadata">

  <span class="article-date">
    <time datetime="2017-11-05 00:00:00 &#43;0000 UTC" itemprop="datePublished">
      Sun, Nov 5, 2017
    </time>
  </span>

  
  
  
  <span class="article-categories">
    <i class="fa fa-folder"></i>
    
    <a href="/categories/statistics">statistics</a
    >, 
    
    <a href="/categories/study-abroad">study abroad</a
    >
    
  </span>
  
  

  
  
  
  <span class="article-tags">
    <i class="fa fa-tags"></i>
    
    <a href="/tags/medical-statistics">Medical Statistics</a
    >, 
    
    <a href="/tags/inference">inference</a
    >, 
    
    <a href="/tags/learning-notes">learning notes</a
    >, 
    
    <a href="/tags/london">London</a
    >, 
    
    <a href="/tags/lshtm">LSHTM</a
    >
    
  </span>
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fwinterwang.github.io%2fpost%2flog-likelihood-ratio%2f"
         target="_blank">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=%e5%b0%8d%e6%95%b8%e4%bc%bc%e7%84%b6%e6%af%94%20Log-likelihood%20ratio&amp;url=https%3a%2f%2fwinterwang.github.io%2fpost%2flog-likelihood-ratio%2f"
         target="_blank">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwinterwang.github.io%2fpost%2flog-likelihood-ratio%2f&amp;title=%e5%b0%8d%e6%95%b8%e4%bc%bc%e7%84%b6%e6%af%94%20Log-likelihood%20ratio"
         target="_blank">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=https%3a%2f%2fwinterwang.github.io%2fpost%2flog-likelihood-ratio%2f&amp;title=%e5%b0%8d%e6%95%b8%e4%bc%bc%e7%84%b6%e6%af%94%20Log-likelihood%20ratio"
         target="_blank">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=%e5%b0%8d%e6%95%b8%e4%bc%bc%e7%84%b6%e6%af%94%20Log-likelihood%20ratio&amp;body=https%3a%2f%2fwinterwang.github.io%2fpost%2flog-likelihood-ratio%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>

    <div class="article-style" itemprop="articleBody">
      <div id="-log-likelihood-ratio" class="section level3">
<h3>對數似然比 Log-likelihood ratio</h3>
<p>對數似然比的想法來自於將對數似然方程圖形的 <span class="math inline">\(y\)</span> 軸重新調節 (rescale) 使之最大值爲零。這可以通過計算該分佈方程的<strong>對數似然比 (log-likelihood ratio)</strong> 來獲得：</p>
<p><span class="math display">\[llr(\theta)=\ell(\theta|data)-\ell(\hat{\theta}|data)\]</span></p>
<p>由於 <span class="math inline">\(\ell(\theta)\)</span> 的最大值在 <span class="math inline">\(\hat{\theta}\)</span> 時， 所以，<span class="math inline">\(llr(\theta)\)</span> 就是個當 <span class="math inline">\(\theta=\hat{\theta}\)</span> 時取最大值，且最大值爲零的方程。很容易理解我們叫這個方程爲對數似然比，因爲這個方程就是將似然比 <span class="math inline">\(LR(\theta)=\frac{L(\theta)}{L(\hat{\theta})}\)</span> 取對數而已。</p>
<p><a href="https://winterwang.github.io/post/likelihood/">之前</a>我們也確證了，不包含我們感興趣的參數的方程部分可以忽略掉。還是用上一節 10人中4人患病的例子：</p>
<p><span class="math display">\[L(\pi|X=4)=\binom{10}{4}\pi^4(1-\pi)^{10-4}\\
\Rightarrow \ell(\pi)=log[\pi^4(1-\pi)^{10-4}]\\
\Rightarrow llr(\pi)=\ell(\pi)-\ell(\hat{\pi})=log\frac{\pi^4(1-\pi)^{10-4}}{0.4^4(1-0.4)^{10-4}}\]</span></p>
<p>其實由上也可以看出 <span class="math inline">\(llr(\theta)\)</span> 只是將對應的似然方程的 <span class="math inline">\(y\)</span> 軸重新調節了一下而已。形狀是沒有改變的：</p>
<pre class="r"><code>par(mfrow=c(1,2))
x &lt;- seq(0,1,by=0.001)
y &lt;- (x^4)*((1-x)^6)/(0.4^4*0.6^6)
z &lt;- log((x^4)*((1-x)^6))-log(0.4^4*0.6^6)
plot(x, y, type = &quot;l&quot;, ylim = c(0,1.1),yaxt=&quot;n&quot;,
     frame.plot = FALSE, ylab = &quot;LR(\U03C0)&quot;, xlab = &quot;\U03C0&quot;)
axis(2, at=seq(0,1, 0.2), las=2)
title(main = &quot;Binomial likelihood ratio&quot;)
abline(h=1.0, lty=2)
segments(x0=0.4, y0=0, x1=0.4, y1=1, lty = 2)
plot(x, z, type = &quot;l&quot;, ylim = c(-10, 1), yaxt=&quot;n&quot;, frame.plot = FALSE,
     ylab = &quot;llr(\U03C0)&quot;, xlab = &quot;\U03C0&quot; )
axis(2, at=seq(-10, 0, 2), las=2)
title(main = &quot;Binomial log-likelihood ratio&quot;)
abline(h=0, lty=2)
segments(x0=0.4, y0=-10, x1=0.4, y1=0, lty = 2)</code></pre>
<p><img src="/post/2017-11-05-log-likelihood-ratio_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<div class="section level4">
<h4>正態分佈數據的最大似然和對數似然比</h4>
<p>假設單個樣本 <span class="math inline">\(y\)</span> 是來自一組服從正態分佈數據的觀察值：<span class="math inline">\(Y\sim N(\mu, \tau^2)\)</span></p>
<p>那麼有：</p>
<p><span class="math display">\[
\begin{aligned}
f(y|\mu) &amp;= \frac{1}{\sqrt{2\pi\tau^2}}e^{(-\frac{1}{2}(\frac{y-\mu}{\tau})^2)} \\
\Rightarrow L(\mu|y) &amp;=\frac{1}{\sqrt{2\pi\tau^2}}e^{(-\frac{1}{2}(\frac{y-\mu}{\tau})^2)} \\
\Rightarrow \ell(\mu)&amp;=log(\frac{1}{\sqrt{2\pi\tau^2}})-\frac{1}{2}(\frac{y-\mu}{\tau})^2\\
omitting&amp;\;terms\;not\;in\;\mu \\
&amp;= -\frac{1}{2}(\frac{y-\mu}{\tau})^2 \\
\Rightarrow \ell^\prime(\mu) &amp;= 2\cdot[-\frac{1}{2}(\frac{y-\mu}{\tau})\cdot\frac{-1}{\tau}] \\
&amp;=\frac{y-\mu}{\tau^2} \\
let \; \ell^\prime(\mu) &amp;= 0 \\
\Rightarrow \frac{y-\mu}{\tau^2} &amp;= 0 \Rightarrow \hat{\mu} = y\\
\because \ell^{\prime\prime}(\mu) &amp;=  \frac{-1}{\tau^2} &lt; 0 \\
\therefore \hat{\mu} &amp;= y \Rightarrow \ell(\hat{\mu}=y)_{max}=0 \\
llr(\mu)&amp;=\ell(\mu)-\ell(\hat{\mu})=\ell(\mu)\\
&amp;=-\frac{1}{2}(\frac{y-\mu}{\tau})^2
\end{aligned}
\]</span></p>
</div>
</div>
<div id="n-" class="section level3">
<h3><span class="math inline">\(n\)</span> 個獨立正態分佈樣本的對數似然比</h3>
<p>假設一組觀察值來自正態分佈 <span class="math inline">\(X_1,\cdots,X_n\stackrel{i.i.d}{\sim}N(\mu,\sigma^2)\)</span>，先假設 <span class="math inline">\(\sigma^2\)</span> 已知。將觀察數據 <span class="math inline">\(x_1,\cdots, x_n\)</span> 標記爲 <span class="math inline">\(\underline{x}\)</span>。 那麼：</p>
<p><span class="math display">\[
\begin{aligned}
L(\mu|\underline{x}) &amp;=\prod_{i=1}^nf(x_i|\mu)\\
\Rightarrow \ell(\mu|\underline{x}) &amp;=\sum_{i=1}^nlogf(x_i|\mu)\\
&amp;=\sum_{i=1}^n[-\frac{1}{2}(\frac{x_i-\mu}{\sigma})^2]\\
&amp;=-\frac{1}{2\sigma^2}\sum_{i=1}^n(x_i-\mu)^2\\
&amp;=-\frac{1}{2\sigma^2}[\sum_{i=1}^n(x_i-\bar{x})^2+\sum_{i=1}^n(\bar{x}-\mu)^2]\\
omitting&amp;\;terms\;not\;in\;\mu \\
&amp;=-\frac{1}{2\sigma^2}\sum_{i=1}^n(\bar{x}-\mu)^2\\
&amp;=-\frac{n}{2\sigma^2}(\bar{x}-\mu)^2 \\
&amp;=-\frac{1}{2}(\frac{\bar{x}-\mu}{\sigma/\sqrt{n}})^2\\
\because \ell(\hat{\mu}) &amp;= 0 \\
\therefore llr(\mu) &amp;= \ell(\mu)-\ell(\hat{\mu}) = \ell(\mu)
\end{aligned}
\]</span></p>
</div>
<div id="n-" class="section level3">
<h3><span class="math inline">\(n\)</span> 個獨立正態分佈樣本的對數似然比的分佈</h3>
<p>假設我們用 <span class="math inline">\(\mu_0\)</span> 表示總體均數這一參數的值。要注意的是，每當樣本被重新取樣，似然，對數似然方程，對數似然比都隨着觀察值而變 (即有自己的分佈)。</p>
<p>考慮一個服從正態分佈的單樣本 <span class="math inline">\(Y\)</span>: <span class="math inline">\(Y\sim N(\mu_0,\tau^2)\)</span>。那麼它的對數似然比：</p>
<p><span class="math display">\[llr(\mu_0|Y)=\ell(\mu_0)-\ell(\hat{\mu})=-\frac{1}{2}(\frac{Y-\mu_0}{\tau})^2\]</span></p>
<p>根據<a href="https://winterwang.github.io/post/chi-square-distribution/">卡方分佈</a>的定義：</p>
<p><span class="math display">\[\because \frac{Y-\mu_0}{\tau}\sim N(0,1)\\
\Rightarrow (\frac{Y-\mu_0}{\tau})^2 \sim \mathcal{X}_1^2\\
\therefore -2llr(\mu_0|Y) \sim \mathcal{X}_1^2\]</span></p>
<p>所以，如果有一組服從正態分佈的觀察值：<span class="math inline">\(X_1,\cdots,X_n\stackrel{i.i.d}{\sim}N(\mu_0,\sigma^2)\)</span>，且 <span class="math inline">\(\sigma^2\)</span> 已知的話：</p>
<p><span class="math display">\[-2llr(\mu_0|\bar{X})\sim \mathcal{X}_1^2\]</span></p>
根據<a href="https://winterwang.github.io/post/central-limit-theory/">中心極限定理</a>，可以將上面的結論一般化： 
<div class="theorem">
<span id="thm:unnamed-chunk-2" class="theorem"><strong>Theorem 1  </strong></span>如果 <span class="math inline">\(X_1,\cdots,X_n\stackrel{i.i.d}{\sim}f(x|\theta)\)</span>。 那麼當重複多次從參數爲 <span class="math inline">\(\theta_0\)</span> 的總體中取樣時，那麼統計量 <span class="math inline">\(-2llr(\theta_0)\)</span> 會漸進於自由度爲 <span class="math inline">\(1\)</span> 的卡方分佈： <span class="math display">\[-2llr(\theta_0)=-2\{\ell(\theta_0)-\ell(\hat{\theta})\}\xrightarrow[n\rightarrow\infty]{}\;\sim \mathcal{X}_1^2\]</span>
</div>

</div>
<div class="section level3">
<h3>似然比信賴區間</h3>
<p>如果樣本量 <span class="math inline">\(n\)</span> 足夠大 (通常應該大於 <span class="math inline">\(30\)</span>)，根據上面的定理：</p>
<p><span class="math display">\[-2llr(\theta_0)=-2\{\ell(\theta_0)-\ell(\hat{\theta})\}\sim \mathcal{X}_1^2\]</span></p>
<p>所以：</p>
<p><span class="math display">\[Prob(-2llr(\theta_0)\leqslant \mathcal{X}_{1,0.95}^2=3.84) = 0.95\\
\Rightarrow Prob(llr(\theta_0)\geqslant-3.84/2=-1.92) = 0.95\]</span></p>
<p>故似然比的 <span class="math inline">\(95\%\)</span> 信賴區間就是能夠滿足 <span class="math inline">\(llr(\theta)=-1.92\)</span> 的兩個 <span class="math inline">\(\theta\)</span> 值。</p>
<div class="section level4">
<h4>以二項分佈數據爲例</h4>
<p>繼續用本文開頭的例子：</p>
<p><span class="math display">\[llr(\pi)=\ell(\pi)-\ell(\hat{\pi})=log\frac{\pi^4(1-\pi)^{10-4}}{0.4^4(1-0.4)^{10-4}}\]</span></p>
<p>如果令 <span class="math inline">\(llr(\pi)=-1.92\)</span> 在代數上可能較難獲得答案。然而從圖形上，如果我們在 <span class="math inline">\(y=-1.92\)</span> 畫一條橫線，和該似然比方程曲線相交的兩個點就是我們想要求的信賴區間的上限和下限：</p>
<pre class="r"><code>x &lt;- seq(0,1,by=0.001)
z &lt;- log((x^4)*((1-x)^6))-log(0.4^4*0.6^6)
plot(x, z, type = &quot;l&quot;, ylim = c(-10, 1), yaxt=&quot;n&quot;, frame.plot = FALSE,
     ylab = &quot;llr(\U03C0)&quot;, xlab = &quot;\U03C0&quot; )
axis(2, at=seq(-10, 0, 2), las=2)
abline(h=0, lty=2)
abline(h=-1.92, lty=2)
segments(x0=0.15, y0=-12, x1=0.15, y1=-1.92, lty = 2)
segments(x0=0.7, y0=-12, x1=0.7, y1=-1.92, lty = 2)
axis(1, at=c(0.15,0.7))
text(0.9, -1, &quot;-1.92&quot;)
arrows(0.8, -1.92, 0.8, 0, lty = 1, length = 0.08)
arrows( 0.8, 0, 0.8, -1.92, lty = 1, length = 0.08)
title(main = &quot;Log-likelihood ratio for binomial example, \n with 95% likelihood confidence interval shown&quot;)</code></pre>
<p><img src="/post/2017-11-05-log-likelihood-ratio_files/figure-html/unnamed-chunk-3-1.png" width="768" /></p>
<p>從上圖中可以讀出，<span class="math inline">\(95\%\)</span> 對數似然比信賴區間就是 <span class="math inline">\((0.15, 0.7)\)</span></p>
</div>
<div class="section level4">
<h4>以正態分佈數據爲例：</h4>
<p>本文前半部分證明過， <span class="math inline">\(X_1,\cdots,X_n\stackrel{i.i.d}{\sim}N(\mu,\sigma^2)\)</span>，先假設 <span class="math inline">\(\sigma^2\)</span> 已知。將觀察數據 <span class="math inline">\(x_1,\cdots, x_n\)</span> 標記爲 <span class="math inline">\(\underline{x}\)</span>。 那麼：</p>
<p><span class="math display">\[llr(\mu|\underline{x}) = \ell(\mu|\underline{x})-\ell(\hat{\mu}) = \ell(\mu|\underline{x}) \\
=-\frac{1}{2}(\frac{\bar{x}-\mu}{\sigma/\sqrt{n}})^2\]</span></p>
<p>很顯然，這是一個關於 <span class="math inline">\(\mu\)</span> 的二次方程，且最大值在 MLE <span class="math inline">\(\hat{\mu}=\bar{x}\)</span> 時取值 <span class="math inline">\(0\)</span>。所以可以通過對數似然比法求出均值的 <span class="math inline">\(95\%\)</span> 信賴區間公式：</p>
<p><span class="math display">\[-2\times[-\frac{1}{2}(\frac{\bar{x}-\mu}{\sigma/\sqrt{n}})^2]=3.84\\
\Rightarrow L=\bar{x}-\sqrt{3.84}\frac{\sigma}{\sqrt{n}} \\
U=\bar{x}+\sqrt{3.84}\frac{\sigma}{\sqrt{n}} \\
note: \;\sqrt{3.84}=1.96\]</span></p>
<p>注意到這和我我們<a href="https://winterwang.github.io/post/frequentist-statistical-inference02/">之前</a>求的正態分佈均值的信賴區間公式完全一致。</p>
</div>
</div>

    </div>
  </div>

</article>

<div class="container">
  <nav>
  <ul class="pager">
    
    <li class="previous"><a href="https://winterwang.github.io/post/likelihood/"><span
      aria-hidden="true">&larr;</span> 似然非然 Likelihood</a></li>
    

    
  </ul>
</nav>

</div>

<div class="article-container">
  

<div id="disqus_thread"></div>
<script>
    

    

    (function() {  
        var d = document, s = d.createElement('script');

        s.src = '//ccwang.disqus.com/embed.js';

        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

</div>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 2017 Chaochen Wang | 王超辰 &middot; 

      Powered by the <a href="https://github.com/gcushen/hugo-academic" target="_blank">Academic
      theme</a> for <a href="http://gohugo.io" target="_blank">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>

    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.4/TweenMax.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/latest/plugins/ScrollToPlugin.min.js"></script>
    <script src="/js/jquery-1.12.3.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/isotope.pkgd.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.1/imagesloaded.pkgd.min.js"></script>
    <script src="/js/hugo-academic.js"></script>
    

    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-21867861-1', 'auto');
        ga('send', 'pageview');

         
        var links = document.querySelectorAll('a');
        Array.prototype.map.call(links, function(item) {
            if (item.host != document.location.host) {
                item.addEventListener('click', function() {
                    var action = item.getAttribute('data-action') || 'follow';
                    ga('send', 'event', 'outbound', action, item.href);
                });
            }
        });
    </script>
    

    
    
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
    </script>
    <script async src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML"></script>
    

  </body>
</html>

