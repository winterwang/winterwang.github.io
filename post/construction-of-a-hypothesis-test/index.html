<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.5.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Chaochen Wang 王　超辰">

  
  
  
    
  
  <meta name="description" content="假設檢驗的構建">

  
  <link rel="alternate" hreflang="en-us" href="https://wangcc.me/post/construction-of-a-hypothesis-test/">

  


  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  





<script async src="https://www.googletagmanager.com/gtag/js?id=UA-21867861-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           document.location = url;
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target);  
  }

  gtag('js', new Date());
  gtag('config', 'UA-21867861-1', {});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="https://wangcc.me/post/construction-of-a-hypothesis-test/">

  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="og:site_name" content="Be Ambitious">
  <meta property="og:url" content="https://wangcc.me/post/construction-of-a-hypothesis-test/">
  <meta property="og:title" content="徒手打造一個假設檢驗 | Be Ambitious">
  <meta property="og:description" content="假設檢驗的構建"><meta property="og:image" content="https://wangcc.me/img/icon-192.png">
  <meta property="twitter:image" content="https://wangcc.me/img/icon-192.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2017-11-08T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2017-11-08T00:00:00&#43;00:00">
  

  


    






  






<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://wangcc.me/post/construction-of-a-hypothesis-test/"
  },
  "headline": "徒手打造一個假設檢驗",
  
  "datePublished": "2017-11-08T00:00:00Z",
  "dateModified": "2017-11-08T00:00:00Z",
  
  "author": {
    "@type": "Person",
    "name": "Chaochen Wang 王　超辰"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Be Ambitious",
    "logo": {
      "@type": "ImageObject",
      "url": "https://wangcc.me/img/icon-512.png"
    }
  },
  "description": "假設檢驗的構建"
}
</script>

  

  


  


  





  <title>徒手打造一個假設檢驗 | Be Ambitious</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0 compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/">Be Ambitious</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav ml-auto">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>Home</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#featured"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#teaching"><span>Teaching</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#slides"><span>Slides</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

      

        

        
        <li class="nav-item">
          <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        

        
        <li class="nav-item">
          <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
        </li>
        

      </ul>

    </div>
  </div>
</nav>


  <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>徒手打造一個假設檢驗</h1>

  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    2017-11-08
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    9 min read
  </span>
  

  
  
  
  <span class="middot-divider"></span>
  <a href="/post/construction-of-a-hypothesis-test/#disqus_thread"></a>
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/categories/statistics/">statistics</a>, <a href="/categories/study-abroad/">study abroad</a></span>
  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style">
      

<div id="TOC">
<ul>
<li><a href="#什麼是假設檢驗-hypothesis-testing">什麼是假設檢驗 Hypothesis testing</a></li>
<li><a href="#錯誤概率和效能方程">錯誤概率和效能方程</a></li>
<li><a href="#如何選擇要檢驗的統計量">如何選擇要檢驗的統計量</a></li>
<li><a href="#複合假設-composite-hypotheses">複合假設 composite hypotheses</a></li>
<li><a href="#如何獲得反對零假設的證據-how-to-quantify-evidence-against-h_0">如何獲得反對零假設的證據 how to quantify evidence against <span class="math inline">\(H_0\)</span></a></li>
<li><a href="#雙側替代假設情況下雙側-p-值的定量方法">雙側替代假設情況下，雙側 <span class="math inline">\(p\)</span> 值的定量方法</a></li>
</ul>
</div>

<div id="什麼是假設檢驗-hypothesis-testing" class="section level3">
<h3>什麼是假設檢驗 Hypothesis testing</h3>
<p>一般來說，我們的<strong>假設</strong>（或者叫<strong>假說</strong>）是對與我們實驗觀察數據來自的總體（或人羣）的<strong>概率分佈</strong>的描述。在參數檢驗的背景下，就是要檢驗描述這個總體（或人羣）的<strong>概率分佈</strong>的參數 (parameters)。最典型的情況是，我們提出兩個互補的假設，一個叫作<strong>零假設</strong>（或者叫<strong>原假設</strong>），null hypothesis (<span class="math inline">\(H_0\)</span>)；另一個是與之對應的（互補的）替代假設，althernative hypothesis (<span class="math inline">\(H_1/H_A\)</span>)。</p>
<p>例如，若 <span class="math inline">\(X\)</span> 是一個服從二項分佈的隨機離散變量 <span class="math inline">\(X\sim Bin(5, \theta)\)</span>。可以考慮如下的零假設和替代假設：<span class="math inline">\(H_0: \theta=\frac{1}{2}; H_1: \theta=\frac{2}{3}\)</span>。</p>
<p>當建立了零假設和替代假設以後，假設檢驗就是要建立如下的規則以確定：</p>
<ol style="list-style-type: decimal">
<li>從樣本中計算所得的參數估計值爲多少時，拒絕零假設。（接受替代假設爲“真”）</li>
<li>從樣本中計算所得的參數估計值爲多少時，零假設不被拒絕。（接受零假設爲“真”）</li>
</ol>
<p>注意：（這一段很繞）</p>
<p>上面的例子是零假設和替代假設均爲簡單假設的情況，實際操作中常常會設計更加複雜的（不對稱的）假設：即簡單的 <span class="math inline">\(H_0\)</span>，複雜的 <span class="math inline">\(H_1\)</span>。如此一來當零假設 <span class="math inline">\(H_0\)</span> 不被拒絕時，我們並不一定就接受之。因爲無證據證明 <span class="math inline">\(H_1\)</span> 不等於有證據證明 <span class="math inline">\(H_0\)</span>。<em><strong>(Absence of evidence is not evidence of absence).</strong></em> 換句話說，無證據讓我們拒絕 <span class="math inline">\(H_0\)</span> 本身並不成爲支持 <span class="math inline">\(H_0\)</span> 爲“真”的證據。因爲在實際操作中，當我們設定的簡單的零假設沒有被拒絕，可能還存在其他符合樣本數據的零假設；相反地，當樣本數據的計算結果拒絕了零假設，我們只能接受替代假設。所以，反對零假設的證據，同時就是支持替代假設的證據。</p>
<p>在樣本空間 sample space 中，決定了零假設 <span class="math inline">\(H_0\)</span> 會被拒絕的子集 subset，被命名爲拒絕域 rejection region 或者 判別區域 critical region，用 <span class="math inline">\(\mathfrak{R}\)</span> 來標記。</p>
</div>
<div id="錯誤概率和效能方程" class="section level3">
<h3>錯誤概率和效能方程</h3>
<p>這一部分可以參考之前<a href="https://winterwang.github.io/post/sample-size-in-clinical-trial/">臨牀試驗樣本量計算</a>的部分。</p>
<table class="table table-striped table-bordered" style="margin-left: auto; margin-right: auto;">
<caption>
Table 1: Definition of Type I and Type II error
</caption>
<thead>
<tr>
<th style="border-bottom:hidden" colspan="2">
</th>
<th style="text-align:center; border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;" colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px;">
SAMPLE
</div>
</th>
</tr>
<tr>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
<span class="math inline">\(\underline{x} \notin \mathfrak{R}\)</span> Accept <span class="math inline">\(H_0\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(\underline{x} \in \mathfrak{R}\)</span> Reject <span class="math inline">\(H_0\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;vertical-align: middle !important;" rowspan="2">
TRUTH
</td>
<td style="text-align:center;">
<span class="math inline">\(H_0\)</span> is true
</td>
<td style="text-align:center;">
<span class="math inline">\(\checkmark\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(\alpha\)</span> <br> Type I error
</td>
</tr>
<tr>
<td style="text-align:center;">
<span class="math inline">\(H_1\)</span> is true
</td>
<td style="text-align:center;">
<span class="math inline">\(\beta\)</span> <br> Type II error
</td>
<td style="text-align:center;">
<span class="math inline">\(\checkmark\)</span>
</td>
</tr>
</tbody>
</table>
<p>假如一個假設檢驗是關於總體參數 <span class="math inline">\(\theta\)</span> 的：</p>
<p><span class="math display">\[H_0: \theta=\theta_0 \;vs.\; H_1: \theta=\theta_1 \]</span></p>
<p>這個檢驗的效能被定義爲當替代假設爲“真”時，拒絕零假設的概率（能夠檢驗出有真實差別的能力）：</p>
<p><strong>Power</strong> <span class="math inline">\(=Prob(\underline{x}\in\mathfrak{R}|H_1\; is\; true) = 1-Prob(Type \; II\; error)\)</span></p>
<p>檢驗的顯著性水平用 <span class="math inline">\(\alpha\)</span> 來表示。<span class="math inline">\(\alpha\)</span> 的直觀意義就是，檢驗結果錯誤的拒絕了零假設 <span class="math inline">\(H_0\)</span>，接受了替代假設 <span class="math inline">\(H_1\)</span>，即假陽性的概率。</p>
<p><span class="math inline">\(Prob(\underline{x}\in \mathfrak{R} |H_0 \;is\;true)=Prob(Type\;I\;error)\)</span></p>
<div id="以二項分佈爲例" class="section level4">
<h4>以二項分佈爲例</h4>
<p>用本文開頭的例子： <span class="math inline">\(X\sim Bin(5,\theta)\)</span>。和我們建立的零假設和替代假設：<span class="math inline">\(H_0: \theta=\frac{1}{2}; H_1: \theta=\frac{2}{3}\)</span>：</p>
<p>考慮兩種檢驗方法：</p>
<ol style="list-style-type: decimal">
<li>A 方法：當且僅當5次觀察都爲“成功”時才拒絕 <span class="math inline">\(H_0 (i.e.\; X=5)\)</span>。所以此時判別區域 <span class="math inline">\(\mathfrak{R}\)</span> 爲 <span class="math inline">\(5\)</span>。檢驗效能爲：<span class="math inline">\(Prob(X=5|H_1 \;is\;true)=(\frac{2}{3})^5=0.1317\)</span>。顯著性水平爲 <span class="math inline">\(Prob(X=5|H_0\;is\;true)=(\frac{1}{2})^5=0.03125\)</span>。</li>
<li>B 方法：當觀察到3,4,5次“成功”時，拒絕 <span class="math inline">\(H_0 (i.e.\; X=3,4,5)\)</span>。此時判別區域 <span class="math inline">\(\mathfrak{R}\)</span> 爲 <span class="math inline">\(3,4,5\)</span>。檢驗效能爲：<span class="math inline">\(Prob(X=3,4,or\:5|H_1\;is\;ture)=\sum_{i=3}^5(\frac{2}{3})^i(\frac{1}{3})^{5-i}\approx0.7901\)</span>；顯著性水平爲：<span class="math inline">\(Prob(X=3,4,5|H_0\;is\;true)=\sum_{i=3}^5(\frac{1}{2})^i(\frac{1}{2})^{5-i}=0.5\)</span></li>
</ol>
<pre class="r"><code># the power in test B
dbinom(3,5,2/3)+dbinom(4,5,2/3)+dbinom(5,5,2/3)</code></pre>
<pre><code>## [1] 0.7901235</code></pre>
<pre class="r"><code># the size in test B
dbinom(3,5,0.5)+dbinom(4,5,0.5)+dbinom(5,5,0.5)</code></pre>
<pre><code>## [1] 0.5</code></pre>
<p>比較上面兩種檢驗方法，可以看到，用B方法時，我們有更高的概率獲得假陽性結果（第一類錯誤，錯誤地拒絕 <span class="math inline">\(H_0\)</span>，接受 <span class="math inline">\(H_1\)</span>)，但是也有更高的檢驗效能（真陽性更高）。這個例子就說明了，試圖提高檢驗效能的同時，會提高犯第一類錯誤的概率。實際操作中我們常常將第一類錯誤的概率固定，例如 <span class="math inline">\(\alpha=0.05\)</span>，然後儘可能選擇效能最高的檢驗方法。</p>
</div>
</div>
<div id="如何選擇要檢驗的統計量" class="section level3">
<h3>如何選擇要檢驗的統計量</h3>
<p>在上面的二項分佈的實驗中，“成功的次數” 是我們感興趣的要檢驗的統計量。但也可能是第一次出現 “成功” 之前的實驗次數，或者，任何與假設相關的統計量。相似的，如果觀察不是離散變量而是連續的，可以拿來檢驗的指標就有很多，如均值，中位數，衆數，幾何平均值等。</p>
<p>幸運地是，當明確了零假設和替代假設後，我們可以利用 <a href="https://en.wikipedia.org/wiki/Neyman%E2%80%93Pearson_lemma">Neyman-Pearson lemma</a> 似然比公式<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>:</p>
<p>來決定使用哪個統計量做檢驗<strong>最有效</strong>：</p>
<p><span class="math display">\[=\frac{L_{H_0}}{L_{H_1}}\]</span></p>
<p>這公式很直觀，因爲當數據更加支持 <span class="math inline">\(H_1\)</span> 時 (<span class="math inline">\(L_{H_1}\)</span> 更大)，<span class="math inline">\(H_0\)</span> 的可能性相對更小，就更應該被拒絕。而且，由於似然比越小，他的對數就越小，使用對數似然比常常更加直觀：<span class="math inline">\(\ell_{H_0}-\ell_{H_1}\)</span>。</p>
<p>那到底要多小才算小？這個進入拒絕域的閾值由兩個指標來決定：</p>
<ol style="list-style-type: decimal">
<li>被檢驗統計量的樣本分佈</li>
<li>第一類錯誤概率 <span class="math inline">\(\alpha\)</span></li>
</ol>
<div id="以已知方差的正態分佈爲例" class="section level4">
<h4>以已知方差的正態分佈爲例</h4>
<p>假如已知 <span class="math inline">\(X_1, \cdots, X_n \stackrel{i.i.d}{\sim} N(\mu, \sigma^2)\)</span> 而且方差 <span class="math inline">\(\sigma^2\)</span> 也是已知的。如果令 <span class="math inline">\(H_0: \mu=5\; ;H_1: \mu=10\)</span> 可以通過如下的方法找到我們需要的最佳檢驗統計量 <u>best statistic</u> 根據之前的<a href="https://winterwang.github.io/post/log-likelihood-ratio/">推導</a>可知正態分佈的似然方程如下：</p>
<p><span class="math display">\[\ell(\mu|\underline{x}) =-\frac{1}{2\sigma^2}\sum_{i=1}^n(x_i-\mu)^2\]</span></p>
<p>所以已知 <span class="math inline">\(\sigma^2\)</span> 時，我們的零假設和替代假設之間的對數似然比 <span class="math inline">\(\ell_{H_0}-\ell_{H_1}\)</span>:</p>
<p><span class="math display">\[\ell_{H_0}-\ell_{H_1}=-\frac{1}{2\sigma^2}(\sum_{i=1}^n(x_i-5)^2-\sum_{i=1}^n(x_i-10)^2)\]</span></p>
<p>然俄，我們只需要考慮隨着數據變化的部分，所以忽略掉不變的部分<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>：</p>
<p><span class="math display">\[
\begin{aligned}
\ell_{H_0}-\ell_{H_1} &amp; = -(\sum_{i=1}^n(x_i-5)^2-\sum_{i=i}^n(x_i-10)^2)\\
                &amp; = 75n - 2\times(10-5)\sum_{i=1}^nx_i \\
\end{aligned}
\]</span></p>
<p>所以只要樣本和 <span class="math inline">\(\sum_{i=1}^nx_i\)</span> <u>(最佳統計量 best statistic)</u> 足夠大，零假設就會被拒絕。而且注意到最佳統計量可以乘以任何常數用作新的最佳統計量。所以爲了方便我們就用樣本均數 <span class="math inline">\(\frac{1}{n}\sum_{i=1}^nx_i\)</span> 作此處的最佳統計量。所以此時，我們的最佳檢驗就是當樣本均值足夠大，超過某個閾值時，我們拒絕零假設。而且，樣本均值的樣本分佈是可以知道的，這樣就便於我們繼續計算下一步：拒絕域 （判別區域）。</p>
</div>
</div>
<div id="複合假設-composite-hypotheses" class="section level3">
<h3>複合假設 composite hypotheses</h3>
<p>目前爲止我們討論的假設檢驗限制太多，實際操作時，我們多考慮類似如下的假設：</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(H_0: \theta=\theta_0 \;v.s.\; H_1: \theta&gt;\theta_0\)</span> [<strong>單側</strong>的替代假設]</li>
<li><span class="math inline">\(H_0: \theta=\theta_0 \;v.s.\; H_1: \theta\neq\theta_0\)</span> [<strong>雙側</strong>的替代假設]</li>
</ol>
<p>所以我們面臨的問題是簡單假設中用於判定的最佳統計量，是否還適用？我們一一來看：</p>
<div id="單側替代假設" class="section level4">
<h4>單側替代假設</h4>
<p>之前的推導中我們發現，樣本均值越大，零假設和替代假設的對數似然比 <span class="math inline">\(\ell_{H_0}-\ell_{H_1}\)</span> 越小。所以我們在樣本均值較大時，拒絕零假設，那麼就可以把原來使用的簡單替代假設 <span class="math inline">\(H_1: \mu=10\)</span> 擴展爲，任意大於 <span class="math inline">\(5\)</span> 的 <span class="math inline">\(\mu\)</span> ，即 <span class="math inline">\(\mu&gt;5\)</span> 。因爲大於 <span class="math inline">\(5\)</span> 的任何均值，都提供了更小的對數似然比，都會讓我們拒絕零假設。所以在正態分佈時，單側替代假設的最佳檢驗統計量還是<strong>樣本均值</strong>。</p>
</div>
<div id="雙側替代假設" class="section level4">
<h4>雙側替代假設</h4>
<p>雙側替代假設的情況下，我們無法繼續使用樣本均值作爲最佳統計量。因爲當我們想檢驗：<span class="math inline">\(H_0: \mu=5 \;v.s.\; H_1: \mu&lt;5\)</span> 時，必須獲得足夠小的樣本均值才能讓我們拒絕零假設。先按下不表。</p>
</div>
</div>
<div id="如何獲得反對零假設的證據-how-to-quantify-evidence-against-h_0" class="section level3">
<h3>如何獲得反對零假設的證據 how to quantify evidence against <span class="math inline">\(H_0\)</span></h3>
<p>重新再考慮符合假設：<span class="math inline">\(H_0: \theta=\theta_0\;v.s.\;H_1: \theta&gt;\theta_0\)</span> 假如存在一個總是可用的最佳檢驗統計量，用 <span class="math inline">\(T\)</span> 來標記 (或 <span class="math inline">\(T(x)\)</span>)， 這個統計量足夠大時，我們拒絕 <span class="math inline">\(H_0\)</span>。 別忘了我們還要定義判別區域：</p>
<p><span class="math display">\[Prob(\underline{x}\in\mathfrak{R}|H_0)=\alpha\]</span></p>
<p>如果我們知道 <span class="math inline">\(T\)</span> 的樣本分佈，我們很容易就可以使用一個閾值 <span class="math inline">\(c\)</span> 來定義這個判別區域：</p>
<p><span class="math display">\[Prob(T\geqslant c|H_0)=\alpha\]</span></p>
<p>更加正式的，我們定義判別區域 <span class="math inline">\(\mathfrak{R}\)</span> 爲：</p>
<p><span class="math display">\[\{\underline{x}:Prob(T(x)\geqslant c|H_0)=\alpha\}\]</span></p>
<p>換句話說，當統計量 <span class="math inline">\(T&gt;c\)</span> 時，我們拒絕 <span class="math inline">\(H_0\)</span> 。如果先不考慮拒絕或不拒絕的二元判定，我們可以用一個連續型測量值來量化反對零假設 <span class="math inline">\(H_0\)</span> 的證據。再考慮從觀察數據中獲得的 <span class="math inline">\(T\)</span> ，即數據告訴我們的 <span class="math inline">\(t\)</span> 。所以，當 <span class="math inline">\(t\)</span> 值越大，說明觀察值相對零假設 <span class="math inline">\(H_0\)</span> 越往極端的方向走。因此我們可以用 <span class="math inline">\(T\)</span> 的樣本分佈來計算觀察值大大於等於這個閾值（極端值）時的概率：</p>
<p><span class="math display">\[p=Prob(T\geqslant t|H_0)\]</span></p>
<p>這個概率公式被稱爲是單側 <span class="math inline">\(p\)</span> 值 <strong>(one-side p-value)</strong>。單側 <span class="math inline">\(p\)</span> 值越小，統計量 <span class="math inline">\(T\)</span> 的樣本空間就有越小比例（越強）的證據支持零假設 <span class="math inline">\(H_0\)</span>。</p>
<p>我們把這以思想用到假設檢驗中時，就可以認爲：</p>
<p><span class="math display">\[p&lt;\alpha \Leftrightarrow t&gt;c\]</span></p>
<p>所以用我們一貫的設定 <span class="math inline">\(\alpha=0.05\)</span>，所以如果計算獲得 <span class="math inline">\(p&lt;0.05\)</span> 我們就認爲獲得了足夠強的拒絕零假設 <span class="math inline">\(H_0\)</span> 的證據。</p>
<div id="回到正態分佈的均值比較問題上來單側替代假設" class="section level4">
<h4>回到正態分佈的均值比較問題上來（單側替代假設）</h4>
<p>繼續考慮 <span class="math inline">\(X_1,\cdots,X_n\stackrel{i.i.d}{\sim} N(\mu, \sigma^2)\)</span>，假設已知 <span class="math inline">\(\sigma^2=10\)</span>，我們要檢驗的是 <span class="math inline">\(H_0: \mu=5 \;v.s.\; H_1: \mu&gt;5\)</span></p>
<ol style="list-style-type: decimal">
<li>確定最佳檢驗統計量：已經證明過，單側替代假設的最佳檢驗統計量是<strong>樣本均值</strong>。</li>
<li>確定該統計量的樣本分佈：已知樣本均數的樣本分佈是 <span class="math inline">\(\bar{X}\sim N(\mu,\sigma^2/n)\)</span> 。<br><span class="math inline">\(\Rightarrow Z=\frac{\bar{X}-\mu}{\sigma/\sqrt{n}} \sim N(0,1)\)</span>，所以在 <span class="math inline">\(H_0\)</span> 條件下，<span class="math inline">\(\Rightarrow Z=\frac{\bar{X}-5}{\sqrt{10}/\sqrt{n}} \sim N(0,1)\)</span></li>
<li>所以當一個檢驗的一類錯誤概率設定爲 <span class="math inline">\(\alpha=0.05\)</span> 時，我們使用的判別區域使統計量據落在該判別區域內的概率爲 <span class="math inline">\(0.05\)</span>：<br> <span class="math inline">\(Prob(\bar{X}\geqslant c|H_0) = 0.05\)</span> <br> 已知在標準正態分佈時，<span class="math inline">\(Prob(Z\geqslant1.64)=0.05=Prob(\frac{\bar{X}-5}{\sqrt{10}/\sqrt{n}}\geqslant1.64)\)</span></li>
<li>假設樣本量是 <span class="math inline">\(10\)</span>，那麼數據的判別區域 <span class="math inline">\(\mathfrak{R}\)</span> 就是 <span class="math inline">\(\bar{X}\geqslant6.64\)</span>。</li>
<li>假設觀察數據告訴我們，<span class="math inline">\(\bar{X}=7.76\)</span> 。那麼這一組觀察數據計算得到的統計量落在了判別區域內，所以說是有足夠的證據拒絕接受 <span class="math inline">\(H_0\)</span> 的。</li>
<li>我們可以給這個觀察數據計算相應的單側 <span class="math inline">\(p\)</span> 值：<br> <span class="math inline">\(p=Prob(\bar{X}\geqslant7.76|H_0)=Prob(Z+5\geqslant7.76)\\=Prob(Z\geqslant2.76)=0.003\)</span> <br> 所以，數據告訴我們，在 <span class="math inline">\(H_0\)</span> 的前提下，觀察值出現的概率是 <span class="math inline">\(0.3\%\)</span> 。即，在無數次取樣實驗中，僅有 <span class="math inline">\(0.3\%\)</span> 的結果可以給出支持 <span class="math inline">\(H_0\)</span> 的證據。因此我們拒絕 <span class="math inline">\(H_0\)</span> 接受 <span class="math inline">\(H_1\)</span>。</li>
</ol>
</div>
</div>
<div id="雙側替代假設情況下雙側-p-值的定量方法" class="section level3">
<h3>雙側替代假設情況下，雙側 <span class="math inline">\(p\)</span> 值的定量方法</h3>
<p><img src="/post/2017-11-08-construction-of-a-hypothesis-test_files/figure-html/unnamed-chunk-3-1.png" width="480" /></p>
<p>此處故意使用一個左右不對稱的概率密度分佈來解釋。</p>
<p>現在的替代假設是雙側的：</p>
<p><span class="math display">\[H_0: \theta=\theta_0 \;v.s.\; H_1:  \theta\neq\theta_0\]</span></p>
<p>正常來說，雙側的假設檢驗應該分成兩個單側檢驗。即：</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(H_1: \theta&gt;\theta_0\)</span>;</li>
<li><span class="math inline">\(H_1: \theta&lt;\theta_0\)</span>.</li>
</ol>
<p>每個單側檢驗都有自己的最佳檢驗統計量。令 <span class="math inline">\(T\)</span> 是 1. 的最佳檢驗統計量，該統計量的樣本分佈如上圖所示（左右不對稱）。假如觀察數據給出的統計量爲 <span class="math inline">\(t2\)</span>，那麼在概率上反對零假設的情況可以有兩種：</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(T\geqslant t2\)</span> 其中， <span class="math inline">\(Prob(T\geqslant t2|H_0)=p1\)</span>;</li>
<li><span class="math inline">\(T\leqslant t1\)</span> 其中， <span class="math inline">\(Prob(T\leqslant t1|H_0) =p1\)</span></li>
</ol>
<p>所以概率密度分佈兩側的距離可以不對稱，但是只要左右兩側概率密度分佈的面積(<span class="math inline">\(=p1\)</span>)相同，那麼就可以直接認爲，雙側 <span class="math inline">\(p\)</span> 值是兩側面積之和 (<span class="math inline">\(p=2\times p1\)</span>)，且觀察數據提供的統計量落在這兩個面積內的話，都足以提供證據拒絕零假設 <span class="math inline">\(H_0\)</span>。</p>
<p>回到上文中單側 <span class="math inline">\(p\)</span> 值爲<span class="math inline">\(0.003\)</span>，故雙側 <span class="math inline">\(p\)</span> 值就是它的兩倍：</p>
<p><span class="math inline">\(p1=Prob(\bar{X}\geqslant7.76|H_0)=Prob(Z+5\geqslant7.76)\\=Prob(Z\geqslant2.76)=0.003\\ \Rightarrow p=2\times p1=0.006\)</span></p>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>區分與<a href="https://winterwang.github.io/post/log-likelihood-ratio/">之前討論的似然比</a>，之前討論的似然比只是所有的似然和極大似然之間的比，此處的似然比只是純粹在探討兩個假設之間可能性之比。<a href="#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>Rememer that <span class="math inline">\(\ell_{H_0}-\ell_{H_1}\)</span> is a random variable: the data varies <strong>each time</strong> we sample, with consequently varying relative support for the hypotheses, and so we are only interested in that part of <span class="math inline">\(\ell_{H_0}-\ell_{H_1}\)</span> which depends on the results, the data, which vary with each sample (i.e. which contains the random part); the constant part provides no information on the relative support the data give to the hypotheses, so we ignore it.<a href="#fnref2" class="footnote-back">↩</a></p></li>
</ol>
</div>

    </div>

    





<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/inference/">inference</a>
  
  <a class="badge badge-light" href="/tags/learning-notes/">learning notes</a>
  
  <a class="badge badge-light" href="/tags/london/">London</a>
  
  <a class="badge badge-light" href="/tags/lshtm/">LSHTM</a>
  
  <a class="badge badge-light" href="/tags/medical-statistics/">Medical Statistics</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https://wangcc.me/post/construction-of-a-hypothesis-test/&amp;text=%e5%be%92%e6%89%8b%e6%89%93%e9%80%a0%e4%b8%80%e5%80%8b%e5%81%87%e8%a8%ad%e6%aa%a2%e9%a9%97" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https://wangcc.me/post/construction-of-a-hypothesis-test/&amp;t=%e5%be%92%e6%89%8b%e6%89%93%e9%80%a0%e4%b8%80%e5%80%8b%e5%81%87%e8%a8%ad%e6%aa%a2%e9%a9%97" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook-f"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=%e5%be%92%e6%89%8b%e6%89%93%e9%80%a0%e4%b8%80%e5%80%8b%e5%81%87%e8%a8%ad%e6%aa%a2%e9%a9%97&amp;body=https://wangcc.me/post/construction-of-a-hypothesis-test/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https://wangcc.me/post/construction-of-a-hypothesis-test/&amp;title=%e5%be%92%e6%89%8b%e6%89%93%e9%80%a0%e4%b8%80%e5%80%8b%e5%81%87%e8%a8%ad%e6%aa%a2%e9%a9%97" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=%e5%be%92%e6%89%8b%e6%89%93%e9%80%a0%e4%b8%80%e5%80%8b%e5%81%87%e8%a8%ad%e6%aa%a2%e9%a9%97%20https://wangcc.me/post/construction-of-a-hypothesis-test/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https://wangcc.me/post/construction-of-a-hypothesis-test/&amp;title=%e5%be%92%e6%89%8b%e6%89%93%e9%80%a0%e4%b8%80%e5%80%8b%e5%81%87%e8%a8%ad%e6%aa%a2%e9%a9%97" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>












  






  
  
  
    
  
  
  <div class="media author-card content-widget-hr">
    
      <img class="portrait mr-3" src="https://s.gravatar.com/avatar/eca3c74b8c4ce437424800c7bc74b67d?s=200')" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title"><a href="https://wangcc.me/">Chaochen Wang 王　超辰</a></h5>
      <h6 class="card-subtitle">Assistant Professor</h6>
      <p class="card-text">All models are wrong, but some are useful.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/outyousin" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.co.jp/citations?user=0J-5evgAAAAJ&amp;hl=ja" target="_blank" rel="noopener">
        <i class="ai ai-google-scholar"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/winterwang" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>




<section id="comments">
  
    
<div id="disqus_thread"></div>
<script>
  let disqus_config = function () {
    
    
    
  };
  (function() {
    if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
      document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
      return;
    }
    var d = document, s = d.createElement('script'); s.async = true;
    s.src = 'https://' + "ccwang" + '.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


  
</section>






  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/post/approximate-log-likelihood-ratios/">二次方程近似法求對數似然比 approximate log-likelihood ratios</a></li>
      
      <li><a href="/post/log-likelihood-ratio/">對數似然比 Log-likelihood ratio</a></li>
      
      <li><a href="/post/likelihood/">似然非然 Likelihood</a></li>
      
      <li><a href="/post/chi-square-distribution/">卡方分佈 chi square distribution</a></li>
      
      <li><a href="/post/frequentist-statistical-inference02/">估計和精確度的概念</a></li>
      
    </ul>
  </div>
  



  </div>
</article>

      

    
    
    
    <script src="/js/mathjax-config.js"></script>
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js" integrity="sha256-1zu+3BnLYV9LdiY85uXMzii3bdrkelyp37e0ZyTAQh0=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/r.min.js"></script>
        
      

      
      
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    
    <script id="dsq-count-scr" src="https://ccwang.disqus.com/count.js" async></script>
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.d6bd04fdad2ad213aa8111c5a3b72fc5.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    &copy; 2017-2019 Chaochen Wang | 王超辰 &middot; 

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
